# HelloWorld

最简单的消息消费模型，生产者producer发送消息到指定名称的队列，消费者consumer从队列中获取消息。

![](img/r2.png)

引入依赖

```xml
<dependency>
    <groupId>com.rabbitmq</groupId>
    <artifactId>amqp-client</artifactId>
    <version>5.7.1</version>
</dependency>
```

生产者

```java
import com.rabbitmq.client.Channel;
import com.rabbitmq.client.Connection;
import com.rabbitmq.client.ConnectionFactory;

public class DemoProducer {

    public static void main(String[] args) {
        ConnectionFactory connectionFactory = new ConnectionFactory();
        connectionFactory.setHost("192.168.24.130");
        connectionFactory.setPort(5672);
        try (Connection connection = connectionFactory.newConnection();
             Channel channel = connection.createChannel()) {

            String queueName = "testQueue1";
            channel.queueDeclare(queueName, false, false, false, null);
            String msg = "hello rabbit";

            channel.basicPublish("", queueName, null, msg.getBytes());

            System.out.println("发送完成");

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

消费者 

注意，这里不能使用`try-with-resource` ，需要保持连接一直激活。

```java
import com.rabbitmq.client.Channel;
import com.rabbitmq.client.Connection;
import com.rabbitmq.client.ConnectionFactory;
import com.rabbitmq.client.DeliverCallback;

import java.nio.charset.StandardCharsets;

public class DemoConsumer {
    public static void main(String[] args) throws Exception {
        ConnectionFactory connectionFactory = new ConnectionFactory();
        connectionFactory.setHost("192.168.24.130");
        connectionFactory.setPort(5672);
        Connection connection = connectionFactory.newConnection();
        Channel channel = connection.createChannel();
        String queueName = "testQueue1";
        channel.queueDeclare(queueName,false,false,false,null);

        DeliverCallback deliverCallback= (s, delivery) -> {
            String msg = new String(delivery.getBody(), StandardCharsets.UTF_8);
            System.out.println(msg);
        };
        channel.basicConsume(queueName,true,deliverCallback,s->{});
        System.out.println("启动监听");
    }
}
```

# 工作队列

# 发布订阅

# 路由模式

# 主题模式

# RPC

# 消息确认

