# 概述

springboot 官方提供了 amqp 的 starter ，用于使用rabbitmq

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-amqp</artifactId>
</dependency>
```

# HelloWorld

引入starter依赖后，项目便会自动进行配置。如需自定义配置，则在`spring.rabbitmq`前缀下更改。

```yaml
spring:
  rabbitmq:
    host: 192.168.24.130
```

项目中需先定义一个 Queue ，这是 spring-amqp 下的包装类，spring 会去一直创建这个queue，即便控制台删了也还是在。

```java
import org.springframework.amqp.core.Queue;

@Configuration
public class RabbitConfig {

    @Bean
    public Queue testQueue(){
        return new Queue("testQueue");
    }
}
```

生产者，任意bean中注入`RabbitTemplate`即可，直接调用发送方法即可往队列中发送消息。

```java
import org.springframework.amqp.rabbit.core.RabbitTemplate;

@RestController
public class HelloController {
    @Autowired
    private RabbitTemplate rabbitTemplate;

    @GetMapping("/hello")
    public String hello(String name){
        String msg = "hello "+name;
        rabbitTemplate.convertAndSend("testQueue",msg);
        return "发送成功";
    }
}
```

消费者，任意bean中，使用`RabbitListener`注解标注一个方法，指定好队列，即可接收String类型的消息。

```java
import org.springframework.amqp.rabbit.annotation.RabbitListener;

@Slf4j
@Component
public class HelloConsumer {

    @RabbitListener(queues = "testQueue")
    public void receive(String msg){
        log.info(msg);
    }
}
```